{"mappings":"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","sources":["public/js/index.js","public/js/leaflet.js","public/js/login.js","public/js/alerts.js","public/js/logout.js","public/js/updateSettings.js"],"sourcesContent":["import { displayMap } from './leaflet';\r\nimport { login } from './login';\r\nimport { logout } from './logout';\r\nimport { updateSettings } from './updateSettings';\r\n\r\n// Dom element\r\nconst mapBox = document.getElementById('map');\r\nconst loginForm = document.querySelector('.form--login');\r\nconst logoutBtn = document.querySelector('.nav__el--logout');\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\n// const bookBtn = document.getElementById('book-tour');\r\n\r\n// Delegation\r\nif (mapBox) {\r\n  const locations = JSON.parse(mapBox.dataset.locations);\r\n  displayMap(locations);\r\n}\r\n\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nif (logoutBtn) {\r\n  logoutBtn.addEventListener('click', logout);\r\n}\r\n\r\nif (userDataForm) {\r\n  userDataForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    const name = document.getElementById('name').value;\r\n    const email = document.getElementById('email').value;\r\n    const file = document.getElementById('photo').files[0];\r\n    const data = { name, email };\r\n    console.log('name: ', name);\r\n    console.log('email: ', email);\r\n    console.log('file: ', file);\r\n\r\n    const form = new FormData();\r\n    form.append('data', JSON.stringify(data));\r\n    if (file) form.append('file', file);\r\n    updateSettings(form, 'data');\r\n  });\r\n}\r\n\r\nif (userPasswordForm) {\r\n  userPasswordForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    document.querySelector('.btn--save-password').textContent =\r\n      'Updating...';\r\n    const passwordCurrent =\r\n      document.getElementById('password-current').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm =\r\n      document.getElementById('password-confirm').value;\r\n    await updateSettings(\r\n      { passwordCurrent, password, passwordConfirm },\r\n      'password',\r\n    );\r\n\r\n    document.querySelector('.btn--save-password').textContent =\r\n      'Save password';\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n  });\r\n}\r\n","/* eslint-disable no-undef */\r\n\r\nexport const displayMap = (locations) => {\r\n  const map = L.map('map').setView([34.124693, -118.113807], 13); // Default center\r\n\r\n  L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    maxZoom: 19,\r\n    attribution:\r\n      '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\r\n  }).addTo(map);\r\n\r\n  const markers = [];\r\n  locations.forEach((loc) => {\r\n    const { coordinates, day, description } = loc; // Extract coordinates & description\r\n    if (coordinates.length === 2) {\r\n      const marker = L.marker([coordinates[1], coordinates[0]]).addTo(map);\r\n\r\n      // Add popup with day and description\r\n      marker\r\n        .bindPopup(\r\n          `<b style=\"font-size: 18px;\">Day ${day} ${description}</b>`,\r\n        )\r\n        .openPopup();\r\n\r\n      markers.push(marker);\r\n    }\r\n  });\r\n\r\n  // If multiple locations exist, adjust the map to fit all markers\r\n  if (markers.length > 0) {\r\n    const group = new L.featureGroup(markers);\r\n    map.fitBounds(group.getBounds(), { padding: [50, 50] }); // Adjust zoom to fit all markers\r\n  }\r\n};\r\n","/* eslint-disable no-undef */\r\nimport { showAlert } from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully!');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    console.log('err=', err);\r\n    const message =\r\n      err?.response?.data?.message || 'Error while login! Try again.';\r\n    showAlert('error', message);\r\n  }\r\n};\r\n","export const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\n// type is 'success' or 'error'\r\nexport const showAlert = (type, msg, time = 7) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, time * 1000);\r\n};\r\n","/* eslint-disable no-undef */\r\nimport { showAlert } from './alerts';\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: '/api/v1/users/logout',\r\n    });\r\n    if (res.data.status === 'success') location.reload(true);\r\n  } catch (error) {\r\n    console.log('Error while logout', error);\r\n    showAlert('error', 'Error logging out! Try again.');\r\n  }\r\n};\r\n","/* eslint-disable no-undef */\r\n\r\nimport { showAlert } from './alerts';\r\n\r\n// type is either 'password' or 'data'\r\nexport const updateSettings = async (data, type) => {\r\n  try {\r\n    const url =\r\n      type === 'password'\r\n        ? '/api/v1/users/update-my-password'\r\n        : '/api/v1/users/update-me';\r\n\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data,\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', `${type.toUpperCase()} updated successfully!`);\r\n    }\r\n  } catch (error) {\r\n    showAlert('error', error.response.data.message);\r\n  }\r\n};\r\n"],"names":[],"version":3,"file":"bundle.js.map","sourceRoot":"../../"}